{% extends "base.html" %}

{% block content %}
<div class="page">
  <section class="person-hero">
    <div class="person-shell">
      <div class="person-avatar">
        {% if person.profile_url %}
          <img src="{{ person.profile_url }}" alt="{{ person.name }}">
        {% else %}
          <div class="poster-skeleton"></div>
        {% endif %}
      </div>
      <div class="person-meta">
        <h1 class="person-name">{{ person.name }}</h1>
        <div class="person-sub">
          {% if person.known_for %}<span>{{ person.known_for }}</span>{% endif %}
          {% if person.birthday %}<span class="dot">&middot;</span><span>{{ person.birthday }}</span>{% endif %}
          {% if person.place_of_birth %}<span class="dot">&middot;</span><span>{{ person.place_of_birth }}</span>{% endif %}
        </div>
        {% if person.biography %}
          <p class="person-bio">{{ person.biography }}</p>
        {% endif %}
      </div>
    </div>
  </section>

  <section class="section detail-section">
    <div class="section-header">
      <span class="section-icon">WORKS</span>
      <h2 class="section-title">代表作</h2>
    </div>
    <div class="section-body">
      {% if person.top_credits %}
        <div class="posters-grid">
          {% for poster in person.top_credits %}
            {% set card_index = loop.index0 %}
            {% include "partials/poster_card.html" %}
          {% endfor %}
        </div>
      {% else %}
        <div class="empty">暂无代表作。</div>
      {% endif %}
    </div>
  </section>

  <section class="section detail-section">
    <div class="section-header">
      <span class="section-icon">ALL</span>
      <h2 class="section-title">全部作品</h2>
    </div>
    <div class="section-body">
      {% if person.all_credits %}
        {% set visible = person.all_credits[:10] %}
        {% set hidden = person.all_credits[10:] %}
        <div class="credits-list">
          {% for c in visible %}
            <div class="credit-row">
              <div class="credit-title">
                <a href="/{{ c.media_type }}/{{ c.id }}">{{ c.title }}</a>
              </div>
              <div class="credit-meta">
                {% if c.year %}<span>{{ c.year }}</span>{% endif %}
                {% if c.role %}<span class="dot">&middot;</span><span>{{ c.role }}</span>{% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
        {% if hidden %}
          <details class="credits-collapse">
            <summary>展开全部作品</summary>
            <div class="credits-list">
              {% for c in hidden %}
                <div class="credit-row">
                  <div class="credit-title">
                    <a href="/{{ c.media_type }}/{{ c.id }}">{{ c.title }}</a>
                  </div>
                  <div class="credit-meta">
                    {% if c.year %}<span>{{ c.year }}</span>{% endif %}
                    {% if c.role %}<span class="dot">&middot;</span><span>{{ c.role }}</span>{% endif %}
                  </div>
                </div>
              {% endfor %}
            </div>
          </details>
        {% endif %}
      {% else %}
        <div class="empty">暂无作品记录。</div>
      {% endif %}
    </div>
  </section>
</div>
{% endblock %}

